<!DOCTYPE html>
<html>
  
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta name="author" content="张文涛">
  
  
  <title>组合数学 | 山海经▪大荒经</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="组合数学,组合数学,">
  

  
  <meta name="description" content="Winter Zhang的小站">

  

  
    <script src="//cdn.jsdelivr.net/npm/leancloud-storage@3.11.1/dist/av-min.js" async></script>
  

  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  

  
    <script src="//unpkg.com/valine/dist/Valine.min.js" async></script>
  

  

  <script>
  // theme-ad's config script
  // it can be used in every script
  
  window.AD_CONFIG = {
    leancloud: {"appid":"J7nVGeFex3em3P8A4ktCiv3b-gzGzoHsz","appkey":"XiR0DX1Kvlh3Et3UalbFN4Dq","comment":true,"count":true},
    welcome: {"enable":false,"interval":30},
    start_time: "2015-02-10",
    passwords: ["c035b468e47fd966ac2df15e3d7f7a64d89b1dbf209c24caad6e62bffd90d4c7", ],
    is_post: true,
    lock: false,
    author: "张文涛",
    share: {"twitter":true,"facebook":true,"weibo":true,"qq":true,"wechat":true},
    mathjax: true,
    page_type: "",
    root: "/"
  };
</script>

  <script src="/vendor/sha256.min.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/index.js"></script>
<script src="/vendor/qrcode.min.js"></script>

  
    <link rel="icon" href="/images/favicon2.ico">
    <link rel="apple-touch-icon" href="/images/touch-icon.png">
  

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="/styles/components/highlight/highlight.css">

  
</head>
  <body>
    <header class="site-header">
  <div class="site-header-brand">
    
      <span class="site-header-brand-title">
        <a href="/">1900</a>
      </span>
    
    
      <span class="site-header-brand-motto"> | 祝你平安幸福 我就不下船了</span>
    
  </div>
  <div class="site-header-right">
    <nav class="site-header-navigation">
      
        <a href="/" target="_self">首页</a>
      
        <a href="/archives/" target="_self">归档</a>
      
        <a href="/tags/" target="_self">标签</a>
      
        <a href="/categories/" target="_self">分类</a>
      
        <a href="/friends/" target="_self">友链</a>
      
        <a href="/about/" target="_self">关于</a>
      
    </nav>
    <div class="site-header-btn">
      
        <a href="https://github.com/834930269/" target="_blank" id="site-github">
          <i class="fa fa-github-alt"></i>
        </a>
      
      <a href="javascript:void(0);" id="site-search">
        <i class="fa fa-search"></i>
      </a>
      <a href="javascript:void(0);" id="site-nav-btn">
        <i class="fa fa-ellipsis-v"></i>
      </a>
    </div>
  </div>
</header>
<nav class="table-content" id="site-nav">
  <div class="table-content-title">
    <span>导航</span>
  </div>
  <div class="table-content-main">
    <ol class="toc">
      
        <li class="toc-item">
          <a href="/" target="_self">
            首页
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/archives/" target="_self">
            归档
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/tags/" target="_self">
            标签
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/categories/" target="_self">
            分类
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/friends/" target="_self">
            友链
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/about/" target="_self">
            关于
          </a>
        </li>
      
    </ol>
  </div>
</nav>
<div id="site-process"></div>
    <main>
      
  <div class="passage">
  <div class="passage-meta">
    <span>
      <i class="fa fa-calendar"></i>2018-01-25
    </span>
    
      <span>
        | <a href="/categories/组合数学/"><i class="fa fa-bookmark"></i>组合数学</a>
      </span>
    
    
      <span>
        | <i class="fa fa-unlock-alt"></i>UNLOCK
      </span>
    
  </div>
  <h1 class="passage-title">
    组合数学
  </h1>
  
  <article class="passage-article">
    <blockquote>
<p>因为组合数学涉及面广,采取边学边更新.</p>
<blockquote>
<p>预计大部分会摘自《组合数学》</p>
</blockquote>
</blockquote>
<h1 id="【鸽巢定理】"><a href="#【鸽巢定理】" class="headerlink" title="【鸽巢定理】"></a>【鸽巢定理】</h1><p>也叫作<code>狄利克雷抽屉原理</code>以及<code>鞋盒原理</code>. 对于鸽巢定理的简单阐释,粗略的说就是如果有许多鸽子飞进不够多的鸽巢内。那么至少要有一个鸽巢被两个或多个鸽子占据.</p>
<h2 id="简单形式"><a href="#简单形式" class="headerlink" title="简单形式"></a>简单形式</h2><p>很通俗的定理 : 如果要把n+1个物体放进n个盒子内,那么至少有一个盒子包含两个或更多的物体.</p>
<h2 id="简单应用"><a href="#简单应用" class="headerlink" title="简单应用"></a>简单应用</h2><blockquote>
<ol>
<li><p>在13个人中存在两个人,他们的生日在同一个月份里.</p>
</li>
<li><p>设有n对已婚夫妻,至少从这2n个人中选出n+1个人可以保证有一对夫妻.</p>
</li>
</ol>
</blockquote>
<h2 id="应用3"><a href="#应用3" class="headerlink" title="应用3"></a>应用3</h2><h3 id="这一条要拿出来-因为比较重要"><a href="#这一条要拿出来-因为比较重要" class="headerlink" title="这一条要拿出来,因为比较重要"></a>这一条要拿出来,因为比较重要</h3><p><img src="http://ptzw9yyyp.bkt.clouddn.com/wp-content/uploads/2018/01/QQ%E6%88%AA%E5%9B%BE20180125215134.png" alt></p>
<h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>考虑$$m$$个和: $$a_1,a_1+a_2,a_1+a_2+a_3,…,a_1+a_2+a_3+…+a_m$$ 如果这些和当中的任意一个可被$$m$$整除,那么结论就成立。因此,我们可以假设这些和中的每一个除以$$m$$都有一个非零余数,余数等于$$1,2,3,4,…,m-1$$中的一个数。因为有$$m$$个和,而只有$$m-1$$个余数,所以必然有两个序列的和除以$$m$$有相同的余数.因此,存在整数$$k,l,k \&lt; l$$,使得$$a_1+a_2+…+a_k$$和$$a_1+a_2+…+a_l$$除以$$m$$有相同的余数$$r$$: $$a_1+a_2+…+a_k = bm+r,a_1+a_2+…+a_l = cm+r$$ 二式相减,我们发现$$ a_{k+1} $$+$$a_{k+2}+…+a_l = (c-b)m$$。 从而推断出,$$m$$个正整数的序列.一定存在一组序列的和为$$m$$的整数倍. <strong>上面的Latex公示如果没显示完全看下面的图片(PS:Latex公式好麻烦,而且支持也好麻烦):</strong> <a href="http://ptzw9yyyp.bkt.clouddn.com/wp-content/uploads/2018/01/QQ截图20180125215217.png" target="_blank" rel="noopener"><img src="http://ptzw9yyyp.bkt.clouddn.com/wp-content/uploads/2018/01/QQ%E6%88%AA%E5%9B%BE20180125215217.png" alt></a></p>
<h3 id="具体应用POJ2356"><a href="#具体应用POJ2356" class="headerlink" title="具体应用POJ2356"></a>具体应用POJ2356</h3><p>题意:输入N个正整数,选择序列中的一些数字,使其和为$$N\*k$$(k为正整数). 代码:</p>
<pre><code>//问从N个数中选取多少个数,使得这些数的和%N==0
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int maxn=10000+10;
int num[maxn],sum[maxn];
int r[maxn];
int main(){
    int N,ans=0,k=0,l=1;
    memset(r,-1,sizeof(r));
    scanf(&quot;%d&quot;,&amp;N);
    sum[0]=0;

    for(int i=1;i&lt;=N;++i){
        scanf(&quot;%d&quot;,&amp;num[i]);
        sum[i]=sum[i-1]+num[i];

        int remainder=sum[i]%N;
        if(remainder==0){
            ans=i;
            k=0;
            l=i;
        }else if(r[remainder]!=-1){
            ans=i-r[remainder];
            k=r[remainder];
            l=i;
        }else r[remainder]=i;
    }
    printf(&quot;%d\n&quot;,ans);
    for(int i=k+1;i&lt;=l;++i){
        printf(&quot;%d\n&quot;,num[i]);
    }
    return 0;
}</code></pre><h1 id="基本计数方法"><a href="#基本计数方法" class="headerlink" title="基本计数方法"></a>基本计数方法</h1><h2 id="加法原理"><a href="#加法原理" class="headerlink" title="加法原理"></a>加法原理</h2><blockquote>
<p>做一件事情有n种方法,第i中方法有Pi种方案,则一共有P1+P2+P3+…+Pn种方法.</p>
</blockquote>
<h2 id="乘法原理"><a href="#乘法原理" class="headerlink" title="乘法原理"></a>乘法原理</h2><blockquote>
<p>做一件事情有n个步骤,第i个步骤有Pi种方案,则一共有P1P2P3…Pn中方案.</p>
</blockquote>
<h2 id="容斥原理"><a href="#容斥原理" class="headerlink" title="容斥原理"></a>容斥原理</h2><blockquote>
<p>最基本的公式:</p>
<blockquote>
<p>|A∪B∪C|=|A|+|B|+|C|-|A∩B|-|A∩C|-|B∩C|+|A∩B∩C|</p>
</blockquote>
</blockquote>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><h4 id="错位排列"><a href="#错位排列" class="headerlink" title="错位排列"></a>错位排列</h4><blockquote>
<p>待填充</p>
</blockquote>
<h1 id="组合问题"><a href="#组合问题" class="headerlink" title="组合问题"></a>组合问题</h1><blockquote>
<p>有n个不同的数,选出k个(顺序无关),每个数最多选一次,有多少种选法?</p>
<blockquote>
<p>记答案为C(n,k)。把n选k的排列问题看成两个步骤,首先选出k个数的组合,然后把这k个数进行全排列.由乘法原理知:</p>
<blockquote>
<p>P(n,k)=C(n,k)*P(k,k) 即<br>C(n,k)=n!/((n-k)!k!)</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="性质1"><a href="#性质1" class="headerlink" title="性质1"></a>性质1</h2><blockquote>
<p>C(n,0)=C(n,n)=1</p>
</blockquote>
<h2 id="性质2"><a href="#性质2" class="headerlink" title="性质2"></a>性质2</h2><blockquote>
<p>C(n,k)=C(n,n-k)</p>
</blockquote>
<h2 id="性质3"><a href="#性质3" class="headerlink" title="性质3"></a>性质3</h2><blockquote>
<p>C(n,k)+C(n,k+1)=C(n+1,k+1) 通常用于预处理C(n+1,…)</p>
</blockquote>
<h2 id="性质4"><a href="#性质4" class="headerlink" title="性质4"></a>性质4</h2><blockquote>
<p>C(n,k+1)=C(n,k)*(n-k)/(k+1) 使用这个公式可以在O(n)的时间内求出C(n) 但注意不要发生乘法溢出.及后面的除法溢出</p>
</blockquote>
<h3 id="性质4通常运用-gt-二项式展开"><a href="#性质4通常运用-gt-二项式展开" class="headerlink" title="性质4通常运用 =&gt; 二项式展开"></a>性质4通常运用 =&gt; 二项式展开</h3><blockquote>
<p>问题:</p>
<blockquote>
<p>求(a+b)^n展开式的各项系数</p>
<blockquote>
<p>二项式定理 (a+b)^n=Sigma(k=0~n)C(n,k)a^(n-k)b^k</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="其余三个问题"><a href="#其余三个问题" class="headerlink" title="其余三个问题"></a>其余三个问题</h2><h2 id="有重复元素的全排列"><a href="#有重复元素的全排列" class="headerlink" title="有重复元素的全排列"></a>有重复元素的全排列</h2><blockquote>
<p>有重复元素的全排列</p>
<blockquote>
<p>有k个元素,其中第i个元素有Ni个,求全排列个数.</p>
<blockquote>
<p>直接看结论,可以简单证得 N1!*N2!*N3!<em>…\</em>Nn!*ans=N! (移项即可)</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="可重复选择的组合"><a href="#可重复选择的组合" class="headerlink" title="可重复选择的组合"></a>可重复选择的组合</h2><blockquote>
<p>可重复选择的组合</p>
<blockquote>
<p>有n个不同的元素,每个元素可以选择多次,一共选k个元素,有多少种选法?</p>
<blockquote>
<p>例如n=3,k=2有6种</p>
<blockquote>
<p>(1,1)、(1,2)、(1,3)、(2,2)、(2,3)、(3,3)</p>
</blockquote>
</blockquote>
<p>分析:</p>
<blockquote>
<p>设第i个元素选xi个,问题转化为求方程x1+x2+…+x3=k的非负整数解的个数. 令yi=xi+1,则答案为 y1+y2+y3+…+yn=k+n</p>
</blockquote>
</blockquote>
<p>没太搞懂,直接放答案吧 C(k+n-1,n-1) =C(n+k-1,k)(性质2)</p>
</blockquote>
<h2 id="单色三角形"><a href="#单色三角形" class="headerlink" title="单色三角形"></a>单色三角形</h2><blockquote>
<p>给定空间内的n(n&lt;=1000)个点,其中没有三点共线,每两个点之间都用红色或黑色线段链接.求三条边同色的三角形个数.</p>
<blockquote>
<p>考虑非单色三角形. 如果第i个点连接了ai条红边和n-1-ai条黑边,则这些边属于ai(n-1-ai)个非单色三角形。每个非单色三角形被考虑了两次,所以最终答案除以2 即 1/2*Sigma(i=1~n) ai(n-1-ai) 用总三角形减去非单色即为单色三角形个数</p>
</blockquote>
</blockquote>
<h1 id="生成函数"><a href="#生成函数" class="headerlink" title="生成函数"></a>生成函数</h1><blockquote>
<p>母函数是用于解决组合问题计数的一种方法。 在了解它之前我们先看看熟悉的杨辉三角。</p>
</blockquote>
<p><img src="http://ptzw9yyyp.bkt.clouddn.com/wp-content/uploads/2018/01/20170611212741764.jpg" alt></p>
<blockquote>
<p>杨辉三角的第n行(注意是从0开始标号的)的数字就是(1+x)^n的展开式从低项到高项的各项系数，也可以表示为组合数的形式C(i,n)。如果将两者联系起来我们会发现，(1+x)可以看成对于一件取舍，1=x^0就是不取，x就是取。这样在(1+x)^n的展开式中x^i项的系数就是从n件物品选取i件的方案数。</p>
</blockquote>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote>
<p>给定数列a0,a1,a2…an，构造函数</p>
<blockquote>
<p>G(x)=a0f0(x)+a1f1(x)+a2f2(x)…anfn(x)</p>
<blockquote>
<p>其中G(x)就是该序列的母函数，f0(x),f1(x),f2(x)…fn(x)为标志函数。 母函数主要有两种形式：普通型母函数和指数型母函数。</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="普通型母函数"><a href="#普通型母函数" class="headerlink" title="普通型母函数"></a>普通型母函数</h3><blockquote>
<p>先看一个例题：HDU 1085</p>
<blockquote>
<p>普通型母函数的标志函数一般为x^0,x^1,x^2…x^n</p>
</blockquote>
<p>因为每个硬币有个数限制，但是也不难构造出</p>
<blockquote>
<p>G(x)=(1+x+x^2+x^3+…+x^num1)(1+x^2+x^4+…+x^(2∗num2))(1+x^5+x^10+…+x^(5∗num5)) 。</p>
</blockquote>
<p>将多项式展开后，x^i项对应的系数就是组成面值为i的方案数。 例题: 51nod 1383</p>
</blockquote>
<h3 id="指数型母函数"><a href="#指数型母函数" class="headerlink" title="指数型母函数"></a>指数型母函数</h3><blockquote>
<p>再看一个例题：HDU 1521</p>
<blockquote>
<p>指数型母函数的标志函数一般为x^0/0!,x^1/1!,x^2/2!…x^n/n!，对于x^i/i!表示在一个方案中某个元素出现了i次，而不同位置的该种元素本质不同，所以在记方案数时只算作一种，所以最后结果应处以i！</p>
</blockquote>
<p>对于这道题就不难构造出母函数为</p>
<blockquote>
<p>G(x)=(1/0!+X/1!+X^2/2!+…+X^a1/a1!)(1/0!+X/1!+X^2/2!+…+X^a2/a2!)(1/0!+X/1!+X^2/2!+…+X^an/an!)</p>
</blockquote>
</blockquote>
<h1 id="Catalan数列"><a href="#Catalan数列" class="headerlink" title="Catalan数列"></a>Catalan数列</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><h3 id="待整理"><a href="#待整理" class="headerlink" title="待整理"></a>待整理</h3><blockquote>
<p>Catalan数列可以解决很多问题.</p>
<blockquote>
<p>比如51nod 1120</p>
</blockquote>
</blockquote>
<h2 id="Catalan前几项"><a href="#Catalan前几项" class="headerlink" title="Catalan前几项"></a>Catalan前几项</h2><pre><code>1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, 6564120420, 24466267020, 91482563640, 343059613650, 1289904147324, 4861946401452, 18367353072152, 69533550916004, 263747951750360, 1002242216651368, 3814986502092304, 14544636039226909, 55534064877048198, 212336130412243110, 812944042149730764, 3116285494907301262, 11959798385860453492, 45950804324621742364, ...</code></pre><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><h3 id="一个小链接"><a href="#一个小链接" class="headerlink" title="一个小链接"></a>一个小链接</h3><p><a href="https://www.cnblogs.com/yaoyueduzhen/p/5456490.html" title="Catalan应用及介绍" target="_blank" rel="noopener">Catalan应用及介绍</a></p>
<h3 id="待整理-1"><a href="#待整理-1" class="headerlink" title="待整理"></a>待整理</h3><h2 id="三种方法求Catalan整合"><a href="#三种方法求Catalan整合" class="headerlink" title="三种方法求Catalan整合"></a>三种方法求Catalan整合</h2><h3 id="注-其中有牵扯Lucas-Lucas在下面-直接放代码-注释在代码中-有对各个类型进行耗时对比"><a href="#注-其中有牵扯Lucas-Lucas在下面-直接放代码-注释在代码中-有对各个类型进行耗时对比" class="headerlink" title="注:其中有牵扯Lucas,Lucas在下面,直接放代码,注释在代码中,有对各个类型进行耗时对比"></a>注:其中有牵扯Lucas,Lucas在下面,直接放代码,注释在代码中,有对各个类型进行耗时对比</h3><h3 id="注2-求逆元中牵扯到了费马求逆元和欧拉求逆元"><a href="#注2-求逆元中牵扯到了费马求逆元和欧拉求逆元" class="headerlink" title="注2:求逆元中牵扯到了费马求逆元和欧拉求逆元"></a>注2:求逆元中牵扯到了费马求逆元和欧拉求逆元</h3><pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;
typedef long long LL;
const int mod=1e9+7;
const int maxn=1000000+10;
LL h[10100];

//函数功能: 预处理前N向Catalan
//函数参数: n为项数
//适合N比较小的情况
void Catalan(int n){
    h[0] = h[1] = 1;        //h(0)和h(1)
    for(int i = 2; i &lt;= n; i++)    //依次计算h(2),h(3)...h(n)
    {
        h[i] = 0;
        for(int j = 0; j &lt; i; j++) //根据递归式计算 h(i)= h(0)*h(i-1)+h(1)*h(i-2) + ... + h(i-1)h(0)
            h[i] = (h[i]+(h[j] * h[i-1-j])%mod)%mod;
    }
}

///h(n)=C(2n,n)/(n+1) (n=0,1,2,...)
///+逆元+Lucas组合数取模
///预处理逆元的话,大小会被限制,直接求的话可能会有常数
///但是N就可以大一点
///返回第N个catalan数
LL inv[maxn];
void init(){
    inv[1]=1;
    for(int i=2;i&lt;maxn;++i){
        inv[i]=(mod-mod/i)*1ll*inv[mod%i]%mod;
    }
}
///Lucas
LL Power_mod(LL a, LL b, LL p)
{
    LL res = 1;
    while(b!=0)
    {
        if(b&amp;1) res = (res*a)%p;
        a = (a*a)%p;
        b &gt;&gt;= 1;
    }
    return res;
}
LL Comb(LL a,LL b, LL p)
{
    if(a &lt; b) return 0;
    if(a == b) return 1;
    if(b &gt; a-b) b = a-b;
    LL ans = 1, ca = 1, cb = 1;
    for(LL i=0; i&lt;b; ++i)
    {
        ca = (ca*(a-i))%p;
        cb = (cb*(b-i))%p;
    }
    ans = (ca*Power_mod(cb, p-2, p))%p;
    return ans;
}
LL Lucas(int n, int m, int p)
{
    LL ans = 1;
    while(n &amp;&amp; m &amp;&amp; ans)
    {
        ans = (ans * Comb(n%p, m%p, p))%p;
        n /= p;
        m /= p;
    }
    ///如果等于0则返回1
    return ans==0?1:ans;
}

LL N_L_Catalan(int N){
    return Lucas(2*N,N,mod)*inv[N+1]%mod;
}

///第三种方法
///h(n)=C(2n,n)-C(2n,n+1)
///由上式子可以直接两个Lucas+同余定理解决
///复杂度可能会比第二种方法换成直接求逆元要高点
LL T_Catalan(int N){
    return (Lucas(2*N,N,mod)-Lucas(2*N,N+1,mod)+mod)%mod;
}


///第四种方法
///直接求逆元(扩展欧几里得求逆元)+Lucas
void extgcd(LL a,LL b,LL&amp; d,LL&amp; x,LL&amp; y){
    if(!b){ d=a; x=1; y=0;}
    else{ extgcd(b,a%b,d,y,x); y-=x*(a/b); }
}
LL inverse(LL a,LL n){
    LL d,x,y;
    extgcd(a,n,d,x,y);
    return d==1?(x+n)%n:-1;
}

LL F_Catalan(int N){
    return Lucas(2*N,N,mod)*inverse(1ll*N+1,1ll*mod)%mod;
}

///第五种
///欧拉定理求逆元+Lucas
///mod是素数且与N互质
long long Pow(long long a,long long b){
    long long ans=1;
    while(b){
        if(b&amp;1)
        {
            b--;
            ans=(ans*a)%mod;
        }
        b&gt;&gt;=1;
        a=(a*a)%mod;
    }
    return ans;
}

long long euler(int p)
{
    long long ans=p,a=p;
    long long i;
    for(i=2;i*i&lt;=a;i++)
    {
        if(a%i==0)
        {
            ans=ans/i*(i-1);
            while(a%i==0)
                a/=i;
        }
    }
    if(a&gt;1)
        ans=ans/a*(a-1);
    return ans;
}

long long eu=euler(mod)-1;

long long Einv(long long a)
{
    return Pow(a,eu);
}

LL Fi_Catalan(int N){
    return Lucas(2*N,N,mod)*Einv(1ll*(N+1))%mod;
}

int main(){
    Catalan(10000);
    init();//初始化逆元
    int k;
    while(cin&gt;&gt;k){
        if(k&lt;=10000)
            cout&lt;&lt;&quot;第一种方法(预处理): &quot;&lt;&lt;h[k]&lt;&lt;endl;
        if(k&lt;=1000000)
            cout&lt;&lt;&quot;第二种方法(h(n)=C(2n,n)/(n+1),预处理逆元+Lucas): &quot;&lt;&lt;N_L_Catalan(k)&lt;&lt;endl;
        clock_t startTime,endTime;
        startTime = clock();
        cout&lt;&lt;&quot;第三种方法(h(n)=C(2n,n)-C(2n,n+1),Lucas): &quot;&lt;&lt;T_Catalan(k)&lt;&lt;endl;
        endTime=clock();
        cout&lt;&lt;&quot;  &quot;&lt;&lt;(double)(endTime - startTime) / CLOCKS_PER_SEC &lt;&lt; &quot;s&quot; &lt;&lt; endl;
        startTime = clock();
        cout&lt;&lt;&quot;第四种方法(h(n)=C(2n,n)/(n+1),Lucas+扩欧求逆元): &quot;&lt;&lt;F_Catalan(k)&lt;&lt;endl;
        endTime=clock();
        cout&lt;&lt;&quot;  &quot;&lt;&lt;(double)(endTime - startTime) / CLOCKS_PER_SEC &lt;&lt; &quot;s&quot; &lt;&lt; endl;
        startTime = clock();
        cout&lt;&lt;&quot;第五种方法(h(n)=C(2n,n)/(n+1),Lucas+欧拉定理求逆元): &quot;&lt;&lt;Fi_Catalan(k)&lt;&lt;endl;
        endTime=clock();
        cout&lt;&lt;&quot;  &quot;&lt;&lt;(double)(endTime - startTime) / CLOCKS_PER_SEC &lt;&lt; &quot;s&quot; &lt;&lt; endl;
    }
    return 0;
}</code></pre><h1 id="Lucas"><a href="#Lucas" class="headerlink" title="Lucas"></a>Lucas</h1><h2 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h2><blockquote>
<p>Lucas定理用于对组合数求模</p>
<blockquote>
<p>因为组合数是一个大式子,无法直接求模,所以用到了Lucas</p>
</blockquote>
</blockquote>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><pre><code>///Lucas
LL Power_mod(LL a, LL b, LL p)
{
    LL res = 1;
    while(b!=0)
    {
        if(b&amp;1) res = (res*a)%p;
        a = (a*a)%p;
        b &gt;&gt;= 1;
    }
    return res;
}
LL Comb(LL a,LL b, LL p)
{
    if(a &lt; b) return 0;
    if(a == b) return 1;
    if(b &gt; a-b) b = a-b;
    LL ans = 1, ca = 1, cb = 1;
    for(LL i=0; i&lt;b; ++i)
    {
        ca = (ca*(a-i))%p;
        cb = (cb*(b-i))%p;
    }
    ans = (ca*Power_mod(cb, p-2, p))%p;
    return ans;
}
LL Lucas(int n, int m, int p)
{
    LL ans = 1;
    while(n &amp;&amp; m &amp;&amp; ans)
    {
        ans = (ans * Comb(n%p, m%p, p))%p;
        n /= p;
        m /= p;
    }
    ///如果等于0则返回1
    return ans==0?1:ans;
}</code></pre>
  </article>
  <aside class="table-content" id="site-toc">
  <div class="table-content-title">
    <i class="fa fa-arrow-right fa-lg" id="site-toc-hide-btn"></i>
    <span>目录</span>
  </div>
  <div class="table-content-main">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#【鸽巢定理】"><span class="toc-text">【鸽巢定理】</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#简单形式"><span class="toc-text">简单形式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#简单应用"><span class="toc-text">简单应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用3"><span class="toc-text">应用3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#这一条要拿出来-因为比较重要"><span class="toc-text">这一条要拿出来,因为比较重要</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#证明"><span class="toc-text">证明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#具体应用POJ2356"><span class="toc-text">具体应用POJ2356</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#基本计数方法"><span class="toc-text">基本计数方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#加法原理"><span class="toc-text">加法原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#乘法原理"><span class="toc-text">乘法原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容斥原理"><span class="toc-text">容斥原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#常见问题"><span class="toc-text">常见问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#错位排列"><span class="toc-text">错位排列</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#组合问题"><span class="toc-text">组合问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#性质1"><span class="toc-text">性质1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#性质2"><span class="toc-text">性质2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#性质3"><span class="toc-text">性质3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#性质4"><span class="toc-text">性质4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#性质4通常运用-gt-二项式展开"><span class="toc-text">性质4通常运用 =&gt; 二项式展开</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其余三个问题"><span class="toc-text">其余三个问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有重复元素的全排列"><span class="toc-text">有重复元素的全排列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#可重复选择的组合"><span class="toc-text">可重复选择的组合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单色三角形"><span class="toc-text">单色三角形</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#生成函数"><span class="toc-text">生成函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#定义"><span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#普通型母函数"><span class="toc-text">普通型母函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指数型母函数"><span class="toc-text">指数型母函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Catalan数列"><span class="toc-text">Catalan数列</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#介绍"><span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#待整理"><span class="toc-text">待整理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Catalan前几项"><span class="toc-text">Catalan前几项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用"><span class="toc-text">应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一个小链接"><span class="toc-text">一个小链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#待整理-1"><span class="toc-text">待整理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三种方法求Catalan整合"><span class="toc-text">三种方法求Catalan整合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#注-其中有牵扯Lucas-Lucas在下面-直接放代码-注释在代码中-有对各个类型进行耗时对比"><span class="toc-text">注:其中有牵扯Lucas,Lucas在下面,直接放代码,注释在代码中,有对各个类型进行耗时对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注2-求逆元中牵扯到了费马求逆元和欧拉求逆元"><span class="toc-text">注2:求逆元中牵扯到了费马求逆元和欧拉求逆元</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Lucas"><span class="toc-text">Lucas</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#介绍-1"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code"><span class="toc-text">Code</span></a></li></ol></li></ol>
  </div>
</aside>
  
    <aside class="passage-copyright">
      <div>本文作者: 张文涛</div>
      
        <div>
          原文链接: 
          <a href="" target="_blank">http://be-sunshine.cn/passages/combinatorics/</a>
        </div>
      
      <div>
        版权声明: 本博客所有文章除特别声明外, 均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议. 转载请注明出处!
      </div>
    </aside>
  
  
    <div class="passage-tags">
     
      <a href="/tags/组合数学/"><i class="fa fa-tags"></i>组合数学</a>
    
    </div>
  
</div>

    </main>
    
      
<div class="site-comment-contanier" data-plateform="leancloud">
  
    <p id="site-comment-info">
      <i class="fa fa-spinner fa-spin"></i> 评论加载中
    </p>
    <div id="site-comment"></div>
  
</div>
    
    <div class="site-footer-wrapper">
  <footer class="site-footer">
    
      
        <div class="site-footer-col">
          <h5 class="site-footer-title">博客推荐</h5>
          
            <span class="site-footer-item">
              <a href="https://godbmw.com/" target="_blank">GodBMW</a>
            </span>
          
            <span class="site-footer-item">
              <a href="http://ruanyifeng.com/" target="_blank">阮一峰的个人网站</a>
            </span>
          
        </div>
      
        <div class="site-footer-col">
          <h5 class="site-footer-title">系列教程</h5>
          
            <span class="site-footer-item">
              <a href="https://godbmw.com/categories/webpack4%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/" target="_blank">webpack4系列教程</a>
            </span>
          
            <span class="site-footer-item">
              <a href="https://godbmw.com/design-patterns/" target="_blank">设计模式手册</a>
            </span>
          
        </div>
      
        <div class="site-footer-col">
          <h5 class="site-footer-title">抓到我</h5>
          
            <span class="site-footer-item">
              <a href="https://weibo.com/3260959934/" target="_blank">微博</a>
            </span>
          
            <span class="site-footer-item">
              <a href="https://github.com/834930269" target="_blank">Github</a>
            </span>
          
        </div>
      
    
    <div class="site-footer-info">
      <i class="fa fa-clock-o"></i> 本站已稳定运行<span id="site-time"></span>
    </div>
    
      <div class="site-footer-info">
        <i class="fa fa-paw"></i> 您是本站第 <span id="site-count"></span> 位访客
      </div>
    
    
      <div class="site-footer-info">
        <i class="fa fa-at"></i> Email: 834930269@qq.com
      </div>
    
    <div class="site-footer-info">
      <i class="fa fa-copyright"></i> 
      2019 <a href="https://github.com/dongyuanxin/theme-ad/" target="_blank">Theme-AD</a>.
      Created by <a href="https://godbmw.com/" target="_blank">GodBMW</a>.
      All rights reserved.
    </div>
  </footer>
</div>
    <div id="site-layer" style="display:none;">
  <div class="site-layer-content">
    <div class="site-layer-header">
      <span class="site-layer-header-title" id="site-layer-title"></span>
      <i class="fa fa-close" id="site-layer-close"></i>
    </div>
    <div class="site-layer-body" id="site-layer-container">
      <div class="site-layer-input" id="site-layer-search" style="display: none;">
        <div class="site-layer-input-choose">
          <a href="javascript:void(0);" title="Change Search Engine">Google</a>
        </div>
        <input type="text">
        <i class="fa fa-search"></i>
      </div>
      
        <div class="site-layer-reward" id="site-layer-reward" style="display: none;">
          
            <div>
              <img src="/images/wechat.png" alt="WeChat">
              
                <p>WeChat</p>
              
            </div>
          
            <div>
              <img src="/images/alipay.png" alt="AliPay">
              
                <p>AliPay</p>
              
            </div>
          
        </div>
      
      <div id="site-layer-welcome" style="display:none;"></div>
    </div>
  </div>
</div>
    

<div class="bottom-bar">
  <div class="bottom-bar-left">
    <a href="/passages/poj-3370/" data-enable="true">
      <i class="fa fa-arrow-left"></i>
    </a>
    <a href="/passages/hdu-1849/" data-enable="true">
      <i class="fa fa-arrow-right"></i>
    </a>
  </div>
  <div class="bottom-bar-right">
    <a href="javascript:void(0);" data-enable="true" id="site-toc-show-btn">
      <i class="fa fa-bars"></i>
    </a>
    
      <a href="#site-comment" data-enable="true">
        <i class="fa fa-commenting"></i>
      </a>
    
    <a href="javascript:void(0);" id="site-toggle-share-btn">
      <i class="fa fa-share-alt"></i>
    </a>
    
      <a href="javascript:void(0);" id="site-reward">
        <i class="fa fa-thumbs-up"></i>
      </a>
    
    <a href="javascript:void(0);" id="back-top-btn">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>
</div>
    <div id="share-btn">
  
    <a id="share-btn-twitter" href="javascript:void(0);" target="_blank">
      <i class="fa fa-twitter"></i>
    </a>
  
  
    <a id="share-btn-facebook" href="javascript:void(0);" target="_blank">
      <i class="fa fa-facebook"></i>
    </a>
  
  
    <a id="share-btn-weibo" href="javascript:void(0);" target="_blank">
      <i class="fa fa-weibo"></i>
    </a>
  
  
    <a id="share-btn-qq" href="javascript:void(0);" target="_blank">
      <i class="fa fa-qq"></i>
    </a>
  
  
    <a id="share-btn-wechat" href="javascript:void(0);" target="_blank">
      <i class="fa fa-wechat"></i>
    </a>
  
</div>
    





    
  </body>
</html>