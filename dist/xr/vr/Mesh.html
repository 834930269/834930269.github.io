<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mesh编程 | 阿信 : 地平线上的一匹狼</title>
    <meta name="description" content="VR">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <link rel="stylesheet" href="http://cdn.be-sunshine.cn/winter.css">
    <meta name="keywords" content="VR">
    <link rel="preload" href="/dist/assets/css/0.styles.222434de.css" as="style"><link rel="preload" href="/dist/assets/js/app.9fdec81c.js" as="script"><link rel="preload" href="/dist/assets/js/2.cb9dfe60.js" as="script"><link rel="preload" href="/dist/assets/js/40.61cb74e9.js" as="script"><link rel="prefetch" href="/dist/assets/js/10.c5c372b8.js"><link rel="prefetch" href="/dist/assets/js/11.115e6a38.js"><link rel="prefetch" href="/dist/assets/js/12.bf64e401.js"><link rel="prefetch" href="/dist/assets/js/13.2594d292.js"><link rel="prefetch" href="/dist/assets/js/14.309c938f.js"><link rel="prefetch" href="/dist/assets/js/15.86a4822d.js"><link rel="prefetch" href="/dist/assets/js/16.ba1f3064.js"><link rel="prefetch" href="/dist/assets/js/17.9c5ca544.js"><link rel="prefetch" href="/dist/assets/js/18.c8c21d01.js"><link rel="prefetch" href="/dist/assets/js/19.842c7ba4.js"><link rel="prefetch" href="/dist/assets/js/20.0f2b0327.js"><link rel="prefetch" href="/dist/assets/js/21.c3fcf699.js"><link rel="prefetch" href="/dist/assets/js/22.80d40e90.js"><link rel="prefetch" href="/dist/assets/js/23.bfe33b3c.js"><link rel="prefetch" href="/dist/assets/js/24.6f700125.js"><link rel="prefetch" href="/dist/assets/js/25.c196d11b.js"><link rel="prefetch" href="/dist/assets/js/26.9b0d335b.js"><link rel="prefetch" href="/dist/assets/js/27.e1413af4.js"><link rel="prefetch" href="/dist/assets/js/28.561387ca.js"><link rel="prefetch" href="/dist/assets/js/29.2f6d81c0.js"><link rel="prefetch" href="/dist/assets/js/3.03251d89.js"><link rel="prefetch" href="/dist/assets/js/30.82868fa9.js"><link rel="prefetch" href="/dist/assets/js/31.8b1c7228.js"><link rel="prefetch" href="/dist/assets/js/32.1deebecd.js"><link rel="prefetch" href="/dist/assets/js/33.69bc3d1e.js"><link rel="prefetch" href="/dist/assets/js/34.dbc2c958.js"><link rel="prefetch" href="/dist/assets/js/35.586deaa6.js"><link rel="prefetch" href="/dist/assets/js/36.1678c558.js"><link rel="prefetch" href="/dist/assets/js/37.fb1b608a.js"><link rel="prefetch" href="/dist/assets/js/38.15630dc1.js"><link rel="prefetch" href="/dist/assets/js/39.e98b33ea.js"><link rel="prefetch" href="/dist/assets/js/4.d9ebe5d7.js"><link rel="prefetch" href="/dist/assets/js/41.34e68601.js"><link rel="prefetch" href="/dist/assets/js/42.462c2adf.js"><link rel="prefetch" href="/dist/assets/js/43.df1dd686.js"><link rel="prefetch" href="/dist/assets/js/44.c15d2681.js"><link rel="prefetch" href="/dist/assets/js/45.590ff73c.js"><link rel="prefetch" href="/dist/assets/js/5.b7b10ecd.js"><link rel="prefetch" href="/dist/assets/js/6.e3226cfe.js"><link rel="prefetch" href="/dist/assets/js/7.76a84986.js"><link rel="prefetch" href="/dist/assets/js/8.af8b9b04.js"><link rel="prefetch" href="/dist/assets/js/9.1fd2b5ab.js">
    <link rel="stylesheet" href="/dist/assets/css/0.styles.222434de.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dist/" class="home-link router-link-active"><img src="/dist/logo.png" alt="阿信 : 地平线上的一匹狼" class="logo"> <span class="site-name can-hide">阿信 : 地平线上的一匹狼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dist/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dist/" class="nav-link">语言高级特性</a></li><li class="dropdown-subitem"><a href="/dist/" class="nav-link">Spring技术栈</a></li><li class="dropdown-subitem"><a href="/dist/" class="nav-link">分布式</a></li></ul></li><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dist/" class="nav-link">语言高级特性</a></li><li class="dropdown-subitem"><a href="/dist/" class="nav-link">Flask</a></li><li class="dropdown-subitem"><a href="/dist/programming_language/python/DataScience/numpy.html" class="nav-link">Numpy</a></li></ul></li><li class="dropdown-item"><h4>C++</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dist/note/G1M/Cpp/Cplus.html" class="nav-link">高级语法</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><span class="title">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/Tensorflow2/tf2/Tensorflow_Keras/Keras.html" class="nav-link">Tensorflow</a></li><li class="dropdown-item"><!----> <a href="/dist/ai/ml/Modle_Represen.html" class="nav-link">机器学习</a></li><li class="dropdown-item"><!----> <a href="/dist/ai/dl/about.html" class="nav-link">神经网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="杂记" class="dropdown-title"><span class="title">杂记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">落書</a></li><li class="dropdown-item"><!----> <a href="/dist/zh/first/" class="nav-link">手记</a></li><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">歌记</a></li><li class="dropdown-item"><!----> <a href="/dist/note/poem/pm.html" class="nav-link">诗记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="通用技能" class="dropdown-title"><span class="title">通用技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/general/mysql/mysql.html" class="nav-link">MySql</a></li><li class="dropdown-item"><!----> <a href="/dist/algorithm/dp/dp.html" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/dist/note/G1M/advance_ds/priority_queue.html" class="nav-link">高级数据结构</a></li><li class="dropdown-item"><!----> <a href="/dist/note/G1M/Digital_Image/Introduce.html" class="nav-link">数字图像处理</a></li><li class="dropdown-item"><!----> <a href="/dist/note/G1M/Computer_Graphics/Computer_Graphics.html" class="nav-link">计算机图形学</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="游戏/VR/AR开发" class="dropdown-title"><span class="title">游戏/VR/AR开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/xr/vr/Unity.html" class="nav-link">VR</a></li><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">AR</a></li><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">GameMakerStudio</a></li></ul></div></div><div class="nav-item"><a href="http://be-sunshine.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hexo博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/834930269/834930269.github.io/tree/master/dist" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dist/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dist/" class="nav-link">语言高级特性</a></li><li class="dropdown-subitem"><a href="/dist/" class="nav-link">Spring技术栈</a></li><li class="dropdown-subitem"><a href="/dist/" class="nav-link">分布式</a></li></ul></li><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dist/" class="nav-link">语言高级特性</a></li><li class="dropdown-subitem"><a href="/dist/" class="nav-link">Flask</a></li><li class="dropdown-subitem"><a href="/dist/programming_language/python/DataScience/numpy.html" class="nav-link">Numpy</a></li></ul></li><li class="dropdown-item"><h4>C++</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dist/note/G1M/Cpp/Cplus.html" class="nav-link">高级语法</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><span class="title">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/Tensorflow2/tf2/Tensorflow_Keras/Keras.html" class="nav-link">Tensorflow</a></li><li class="dropdown-item"><!----> <a href="/dist/ai/ml/Modle_Represen.html" class="nav-link">机器学习</a></li><li class="dropdown-item"><!----> <a href="/dist/ai/dl/about.html" class="nav-link">神经网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="杂记" class="dropdown-title"><span class="title">杂记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">落書</a></li><li class="dropdown-item"><!----> <a href="/dist/zh/first/" class="nav-link">手记</a></li><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">歌记</a></li><li class="dropdown-item"><!----> <a href="/dist/note/poem/pm.html" class="nav-link">诗记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="通用技能" class="dropdown-title"><span class="title">通用技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/general/mysql/mysql.html" class="nav-link">MySql</a></li><li class="dropdown-item"><!----> <a href="/dist/algorithm/dp/dp.html" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/dist/note/G1M/advance_ds/priority_queue.html" class="nav-link">高级数据结构</a></li><li class="dropdown-item"><!----> <a href="/dist/note/G1M/Digital_Image/Introduce.html" class="nav-link">数字图像处理</a></li><li class="dropdown-item"><!----> <a href="/dist/note/G1M/Computer_Graphics/Computer_Graphics.html" class="nav-link">计算机图形学</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="游戏/VR/AR开发" class="dropdown-title"><span class="title">游戏/VR/AR开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/xr/vr/Unity.html" class="nav-link">VR</a></li><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">AR</a></li><li class="dropdown-item"><!----> <a href="/dist/" class="nav-link">GameMakerStudio</a></li></ul></div></div><div class="nav-item"><a href="http://be-sunshine.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hexo博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/834930269/834930269.github.io/tree/master/dist" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>虚拟现实</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dist/xr/vr/Unity.html" class="sidebar-link">Unity杂记 - 异步</a></li><li><a href="/dist/xr/vr/FinalIK.html" class="sidebar-link">VRTK使用FinalIK绑定人物模型</a></li><li><a href="/dist/xr/vr/Mesh.html" class="active sidebar-link">Mesh编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#基础知识" class="sidebar-link">基础知识</a></li><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#举个栗子" class="sidebar-link">举个栗子</a></li><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#mesh重绘制法线" class="sidebar-link">Mesh重绘制法线</a></li><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#绘制quads-四顶点-介绍多顶点绘制顺序" class="sidebar-link">绘制Quads - 四顶点(介绍多顶点绘制顺序)</a></li><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#绘制多边形-逐渐扩展至圆形" class="sidebar-link">绘制多边形(逐渐扩展至圆形 )</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#底向内凹陷圆柱" class="sidebar-link">底向内凹陷圆柱</a></li><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#底平滑圆柱" class="sidebar-link">底平滑圆柱</a></li><li class="sidebar-sub-header"><a href="/dist/xr/vr/Mesh.html#双面" class="sidebar-link">双面</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#基础知识">基础知识</a></li><li><a href="#举个栗子">举个栗子</a></li><li><a href="#mesh重绘制法线">Mesh重绘制法线</a></li><li><a href="#绘制quads-四顶点-介绍多顶点绘制顺序">绘制Quads - 四顶点(介绍多顶点绘制顺序)</a></li><li><a href="#绘制多边形-逐渐扩展至圆形">绘制多边形(逐渐扩展至圆形 )</a><ul><li><a href="#底向内凹陷圆柱">底向内凹陷圆柱</a></li><li><a href="#底平滑圆柱">底平滑圆柱</a></li><li><a href="#双面">双面</a></li></ul></li></ul></div><p></p> <h1 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h1> <p>       Mesh编程主要用来处理物体形变.</p> <h2 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h2> <ul><li>Mesh面数</li> <li>Mesh每个面的顶点集(x,y,z)</li> <li>顶点集<code>vertices</code>是一个<code>List&lt;Vector3&gt;</code>类型</li> <li>面集是<code>triangles</code>是一个<code>List&lt;int&gt;</code>类型</li> <li>面集每个int对应的是vertices顶点集中对应的下标</li> <li>对于面的渲染是根据顶点集的顺序进行渲染的</li></ul> <blockquote><p>便绘制边显示在Editor上:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>[ExecuteInEditMode]
</code></pre></div><h2 id="举个栗子"><a href="#举个栗子" class="header-anchor">#</a> 举个栗子</h2> <p>       比如给三个顶点集</p> <ul><li><code>1,3,0</code></li> <li><code>1,2,0</code></li> <li><code>3,2,1</code>
       假设按<code>0,1,2</code>的顺序绘制为正面,则按<code>0,2,1</code>的顺序绘制即为背面
       原理我也不知道啥,先记着吧.<code>这里留白</code></li></ul> <h2 id="mesh重绘制法线"><a href="#mesh重绘制法线" class="header-anchor">#</a> Mesh重绘制法线</h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code>mesh<span class="token punctuation">.</span><span class="token function">RecalculateNormals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="绘制quads-四顶点-介绍多顶点绘制顺序"><a href="#绘制quads-四顶点-介绍多顶点绘制顺序" class="header-anchor">#</a> 绘制Quads - 四顶点(介绍多顶点绘制顺序)</h2> <p>       如果我们需要绘制一个正方形,则我们需要知道正方形各个顶点所在的位置,然后用三角形拼出这个正方形.
       那么<code>顶点顺序是什么呢?</code>见下图:
<img src="http://cdn.be-sunshine.cn/qds.png" alt=""></p> <p>左下角绘制顺序: <code>0-3-2</code>
右上角绘制顺序: <code>0-1-3</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">protected</span> override <span class="token keyword">void</span> <span class="token function">SetTriangles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    triangles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    triangles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    triangles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    triangles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    triangles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    triangles<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>绘制如下:</code></p> <p><img src="http://cdn.be-sunshine.cn/Done.png" alt=""></p> <h2 id="绘制多边形-逐渐扩展至圆形"><a href="#绘制多边形-逐渐扩展至圆形" class="header-anchor">#</a> 绘制多边形(逐渐扩展至圆形 )</h2> <h3 id="底向内凹陷圆柱"><a href="#底向内凹陷圆柱" class="header-anchor">#</a> 底向内凹陷圆柱</h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> UnityEngine<span class="token punctuation">;</span>
<span class="token punctuation">[</span>ExecuteInEditMode<span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token operator">:</span> MonoBehaviour <span class="token punctuation">{</span>

    <span class="token keyword">public</span> MeshFilter meshFilter<span class="token punctuation">;</span>
    <span class="token keyword">public</span> MeshRenderer meshRenderer<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">DrawPolygon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> GameObject drawGo<span class="token punctuation">;</span>
    Mesh <span class="token function">PrepareMesh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        drawGo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>
        drawGo<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">SetParent</span><span class="token punctuation">(</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>
        drawGo<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>localPosition <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">;</span>
        drawGo<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>localScale <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>one<span class="token punctuation">;</span>

        meshRenderer <span class="token operator">=</span> drawGo<span class="token punctuation">.</span>AddComponent<span class="token operator">&lt;</span>MeshRenderer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//meshRenderer.material = mat;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>drawGo<span class="token punctuation">.</span>GetComponent<span class="token operator">&lt;</span>MeshFilter<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            meshFilter <span class="token operator">=</span> drawGo<span class="token punctuation">.</span>GetComponent<span class="token operator">&lt;</span>MeshFilter<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span>
            meshFilter <span class="token operator">=</span> drawGo<span class="token punctuation">.</span>AddComponent<span class="token operator">&lt;</span>MeshFilter<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Mesh mesh <span class="token operator">=</span> meshFilter<span class="token punctuation">.</span>mesh<span class="token punctuation">;</span>
        mesh<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> mesh<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> circle_h <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">DrawPolygon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> circle_count <span class="token operator">=</span> count<span class="token punctuation">;</span>
        Mesh mesh <span class="token operator">=</span> <span class="token function">PrepareMesh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Vector3<span class="token punctuation">[</span><span class="token punctuation">]</span> vertices <span class="token operator">=</span> <span class="token keyword">new</span> Vector3<span class="token punctuation">[</span><span class="token punctuation">(</span>circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//底面圆心</span>
        vertices<span class="token punctuation">[</span><span class="token punctuation">(</span>circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>circle_h<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//划定原点</span>
        vertices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">;</span>
        <span class="token comment">//计算每个度的大小,Deg2Red: 由度数变为弧度 Red2Deg:弧度转度数</span>
        <span class="token keyword">float</span> pre_rad <span class="token operator">=</span> Mathf<span class="token punctuation">.</span>Deg2Rad <span class="token operator">*</span> <span class="token number">360</span> <span class="token operator">/</span> circle_count<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> circle_count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">float</span> deg <span class="token operator">=</span> <span class="token operator">-</span>i <span class="token operator">*</span> pre_rad<span class="token punctuation">;</span>
            <span class="token keyword">float</span> x <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">float</span> z <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3为半径,向下封底则只需要将y值向下移即可,且要转向</span>
            vertices<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Vector3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
            <span class="token comment">//同时记录下封底的坐标</span>
            vertices<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> circle_count<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Vector3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>circle_h<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        mesh<span class="token punctuation">.</span>vertices <span class="token operator">=</span> vertices<span class="token punctuation">;</span>

        <span class="token comment">//中间部分,连接上表面,中间的缝隙可以用多个长方体表示,cover_h表示为底部缝隙处的高,现在已知每两个点的坐标</span>
        <span class="token comment">//ver[i]和ver[i+1]</span>
        <span class="token comment">//即triangle需添加的坐标为: vertices[i],vertices[i+1],vertices[i].y-5   和vertices[i+1]为顶点</span>
        <span class="token comment">//每个顶点会向下加一条边</span>

        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> triangles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>circle_count <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> up_tlen <span class="token operator">=</span> triangles<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token comment">//绘上表面</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> up_tlen<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">int</span> first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> second <span class="token operator">=</span> i <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> third <span class="token operator">=</span> second <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>third <span class="token operator">&gt;</span> circle_count<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                third <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            triangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//绘柱体面</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span> up_tlen<span class="token punctuation">,</span>t<span class="token operator">=</span>circle_count<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> up_tlen<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">,</span>t<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//加入切面的第一个面</span>
            <span class="token keyword">int</span> first <span class="token operator">=</span> t<span class="token operator">-</span>circle_count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> second <span class="token operator">=</span> t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> third <span class="token operator">=</span> t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> up_tlen<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                third <span class="token operator">=</span> circle_count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;UP: &quot;</span> <span class="token operator">+</span> first<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> second<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> third<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>third<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
            <span class="token comment">//加入第二个面</span>
            first <span class="token operator">=</span> t <span class="token operator">-</span> circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            second <span class="token operator">=</span> t <span class="token operator">-</span>circle_count<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
            third <span class="token operator">=</span> second<span class="token operator">+</span>circle_count<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> up_tlen <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                second <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                third <span class="token operator">=</span> second <span class="token operator">+</span> circle_count<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Middle: &quot;</span> <span class="token operator">+</span> first<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> second<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> third<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>third<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> up_tlen<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> up_tlen <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> up_tlen <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//绘下表面</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> up_tlen<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span>t <span class="token operator">=</span> circle_count<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> up_tlen<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">,</span>t<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//地面圆心</span>
            <span class="token keyword">int</span> first <span class="token operator">=</span> <span class="token punctuation">(</span>circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> second <span class="token operator">=</span> t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> third <span class="token operator">=</span> t<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span>up_tlen<span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                third <span class="token operator">=</span> circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            triangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mesh<span class="token punctuation">.</span>triangles <span class="token operator">=</span> triangles<span class="token punctuation">;</span>

        mesh<span class="token punctuation">.</span><span class="token function">RecalculateNormals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p>原理,造出高度差</p></blockquote> <h3 id="底平滑圆柱"><a href="#底平滑圆柱" class="header-anchor">#</a> 底平滑圆柱</h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> UnityEngine<span class="token punctuation">;</span>
<span class="token punctuation">[</span>ExecuteInEditMode<span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token operator">:</span> MonoBehaviour <span class="token punctuation">{</span>

    <span class="token keyword">public</span> MeshFilter meshFilter<span class="token punctuation">;</span>
    <span class="token keyword">public</span> MeshRenderer meshRenderer<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">DrawPolygon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> GameObject drawGo<span class="token punctuation">;</span>
    Mesh <span class="token function">PrepareMesh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        drawGo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>
        drawGo<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">SetParent</span><span class="token punctuation">(</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>
        drawGo<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>localPosition <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">;</span>
        drawGo<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>localScale <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>one<span class="token punctuation">;</span>

        meshRenderer <span class="token operator">=</span> drawGo<span class="token punctuation">.</span>AddComponent<span class="token operator">&lt;</span>MeshRenderer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//meshRenderer.material = mat;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>drawGo<span class="token punctuation">.</span>GetComponent<span class="token operator">&lt;</span>MeshFilter<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            meshFilter <span class="token operator">=</span> drawGo<span class="token punctuation">.</span>GetComponent<span class="token operator">&lt;</span>MeshFilter<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span>
            meshFilter <span class="token operator">=</span> drawGo<span class="token punctuation">.</span>AddComponent<span class="token operator">&lt;</span>MeshFilter<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Mesh mesh <span class="token operator">=</span> meshFilter<span class="token punctuation">.</span>mesh<span class="token punctuation">;</span>
        mesh<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> mesh<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> circle_h <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">DrawPolygon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> circle_count <span class="token operator">=</span> count<span class="token punctuation">;</span>
        Mesh mesh <span class="token operator">=</span> <span class="token function">PrepareMesh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Vector3<span class="token punctuation">[</span><span class="token punctuation">]</span> vertices <span class="token operator">=</span> <span class="token keyword">new</span> Vector3<span class="token punctuation">[</span><span class="token punctuation">(</span>circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//底面圆心</span>
        vertices<span class="token punctuation">[</span><span class="token punctuation">(</span>circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>circle_h<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//划定原点</span>
        vertices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">;</span>
        <span class="token comment">//计算每个度的大小,Deg2Red: 由度数变为弧度 Red2Deg:弧度转度数</span>
        <span class="token keyword">float</span> pre_rad <span class="token operator">=</span> Mathf<span class="token punctuation">.</span>Deg2Rad <span class="token operator">*</span> <span class="token number">360</span> <span class="token operator">/</span> circle_count<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> circle_count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">float</span> deg <span class="token operator">=</span> <span class="token operator">-</span>i <span class="token operator">*</span> pre_rad<span class="token punctuation">;</span>
            <span class="token keyword">float</span> x <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">float</span> z <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3为半径,向下封底则只需要将y值向下移即可,且要转向</span>
            vertices<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Vector3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
            <span class="token comment">//同时记录下封底的坐标</span>
            vertices<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> circle_count<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Vector3</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>circle_h<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        mesh<span class="token punctuation">.</span>vertices <span class="token operator">=</span> vertices<span class="token punctuation">;</span>

        <span class="token comment">//中间部分,连接上表面,中间的缝隙可以用多个长方体表示,cover_h表示为底部缝隙处的高,现在已知每两个点的坐标</span>
        <span class="token comment">//ver[i]和ver[i+1]</span>
        <span class="token comment">//即triangle需添加的坐标为: vertices[i],vertices[i+1],vertices[i].y-5   和vertices[i+1]为顶点</span>
        <span class="token comment">//每个顶点会向下加一条边</span>

        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> triangles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>circle_count <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> up_tlen <span class="token operator">=</span> triangles<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token comment">//绘上表面</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> up_tlen<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">int</span> first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> second <span class="token operator">=</span> i <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> third <span class="token operator">=</span> second <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>third <span class="token operator">&gt;</span> circle_count<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                third <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            triangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//绘柱体面</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> up_tlen<span class="token punctuation">,</span> t <span class="token operator">=</span> circle_count<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> up_tlen <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">,</span> t <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//加入切面的第一个面</span>
            <span class="token keyword">int</span> first <span class="token operator">=</span> t <span class="token operator">-</span> circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> second <span class="token operator">=</span> t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> third <span class="token operator">=</span> t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> up_tlen <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                third <span class="token operator">=</span> circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;UP: &quot;</span> <span class="token operator">+</span> first<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> second<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> third<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>third<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
            <span class="token comment">//加入第二个面</span>
            first <span class="token operator">=</span> t <span class="token operator">-</span> circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            second <span class="token operator">=</span> t <span class="token operator">-</span> circle_count <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            third <span class="token operator">=</span> second <span class="token operator">+</span> circle_count<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> up_tlen <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                second <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                third <span class="token operator">=</span> second <span class="token operator">+</span> circle_count<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Middle: &quot;</span> <span class="token operator">+</span> first<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> second<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> third<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>second<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> vertices<span class="token punctuation">[</span>third<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> up_tlen<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> up_tlen <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> up_tlen <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//绘下表面</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> up_tlen<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span>t <span class="token operator">=</span> circle_count<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> up_tlen<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">,</span>t<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//地面圆心</span>
            <span class="token keyword">int</span> first <span class="token operator">=</span> <span class="token punctuation">(</span>circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> second <span class="token operator">=</span> t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> third <span class="token operator">=</span> t<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span>up_tlen<span class="token operator">*</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                third <span class="token operator">=</span> circle_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            triangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">;</span>
            triangles<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> third<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mesh<span class="token punctuation">.</span>triangles <span class="token operator">=</span> triangles<span class="token punctuation">;</span>

        mesh<span class="token punctuation">.</span><span class="token function">RecalculateNormals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><blockquote><p>原理: 去掉高度差</p></blockquote> <h3 id="双面"><a href="#双面" class="header-anchor">#</a> 双面</h3> <blockquote><p>同样按照上述方式添加三个面,把first和second调换位置就可以了</p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/834930269/834930269.github.io/tree/master/dist/edit/master/docs/xr/vr/Mesh.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dist/xr/vr/FinalIK.html" class="prev">VRTK使用FinalIK绑定人物模型</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/dist/assets/js/app.9fdec81c.js" defer></script><script src="/dist/assets/js/2.cb9dfe60.js" defer></script><script src="/dist/assets/js/40.61cb74e9.js" defer></script>
  </body>
</html>
