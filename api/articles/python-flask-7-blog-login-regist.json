{"title":"Python Flask 7 博客架构一: 登录注册模块","slug":"python-flask-7-blog-login-regist","date":"2017-10-14T14:53:28.000Z","updated":"2019-07-03T13:51:36.858Z","comments":true,"path":"api/articles/python-flask-7-blog-login-regist.json","photos":[],"link":"","excerpt":null,"covers":["http://img.blog.csdn.net/20160924183725708"],"content":"<p><code>1.</code>flask_login模块中,views层判断是否登录用<code>current_user.is_authenticated</code>,但是,<code>flask-login2.x</code>是current_user.is_authenticated<code>()</code>,<code>flask-login3.x</code>是current_user.is_authenticated 即:</p>\n<pre><code>&lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;\n    {% if current_user.is_authenticated %}\n            <li><a href=\"{ { url_for('auth.logout') }}\">Sign Out</a></li>\n        {% else %}\n            <li><a href=\"{ { url_for('auth.login') }}\">Sign In</a></li>\n        {% endif %}\n&lt;/ul&gt;</code></pre><p><code>2.</code>在 <code>SQLAlchemy</code> 中， add() 操作之后数据成为<code>pending</code> 状态，此时数据<code>不会立即</code>写入到数据库中。 当你执行 <code>query()</code> 的时候，它会先把之前状态为 pending 的数据<code>写入到数据库</code>，并且<code>更新当前 session</code> 中存储的数据，然后再执行 <code>query()</code> <code>3.</code>如果出现<code>Can&#39;t locate revision identified by &#39;XXX&#39;</code>,要删除一下数据库中的<code>alembic_version</code>表,保证版本不会互相影响以完成更新.</p>\n<h1 id=\"项目地址-Github\"><a href=\"#项目地址-Github\" class=\"headerlink\" title=\"项目地址(Github):\"></a>项目地址(Github):</h1><p><a href=\"https://github.com/834930269/Flask_Study/tree/master/flask-%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%842-%E6%B3%A8%E5%86%8C%E5%92%8C%E9%82%AE%E7%AE%B1%E9%AA%8C%E8%AF%81\" title=\"flask-大型网站架构2-注册和邮箱验证\" target=\"_blank\" rel=\"noopener\"><code>Click Here: flask-大型网站架构2-注册和邮箱验证</code></a> <code>4.</code>看到了一个之前没太注意的地方: <a href=\"http://img.blog.csdn.net/20160924183725708\" target=\"_blank\" rel=\"noopener\"><img src=\"http://img.blog.csdn.net/20160924183725708\" alt></a> 这里是Flask-Login需要的自己实现的四个函数.可以用一个<code>UserMixin</code>解决.但需要自己实现一个<code>回调函数</code>。 <a href=\"http://img.blog.csdn.net/20160924183906725\" target=\"_blank\" rel=\"noopener\"><img src=\"http://img.blog.csdn.net/20160924183906725\" alt></a> <a href=\"http://img.blog.csdn.net/20160924183919554\" target=\"_blank\" rel=\"noopener\"><img src=\"http://img.blog.csdn.net/20160924183919554\" alt></a> 这就是代码里</p>\n<pre><code>@login_manager.user_loader\ndef load_user(user_id):\n    return User.query.get(int(user_id))</code></pre><p>这段代码的意义. ..有点累..躺尸一会,先不更新了..<code>_(:3」∠)_我的床需要我</code></p>\n","categories":[{"name":"Flask","slug":"Flask","count":18,"path":"api/categories/Flask.json"},{"name":"Python","slug":"Flask/Python","count":16,"path":"api/categories/Flask/Python.json"}],"tags":[{"name":"Flask","slug":"Flask","count":20,"path":"api/tags/Flask.json"},{"name":"Python","slug":"Python","count":65,"path":"api/tags/Python.json"}]}