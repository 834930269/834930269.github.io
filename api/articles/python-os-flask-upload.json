{"title":"python os模块+flask实现文件上传","slug":"python-os-flask-upload","date":"2017-10-08T00:28:45.000Z","updated":"2019-07-03T13:51:36.858Z","comments":true,"path":"api/articles/python-os-flask-upload.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<p>首先是os模块选择上传目录: os.path为初始画一个path对象,他可以将路径转换为标准路径.</p>\n<pre><code>os.path.dirname()</code></pre><p>转到相应文件目录</p>\n<pre><code>os.getcwd()</code></pre><p>获取当前目录</p>\n<pre><code>os.path.join(path1,path2,path3...)</code></pre><p>将所有目录组合起来 实现代码如下:</p>\n<pre><code># -*- coding: utf-8 -*-\nimport os\nfrom flask import Flask, request, url_for, send_from_directory\nfrom werkzeug import secure_filename\nimport logging; logging.basicConfig(level=logging.INFO)\n\nALLOWED_EXTENSIONS = set([&apos;png&apos;, &apos;jpg&apos;, &apos;jpeg&apos;, &apos;gif&apos;])\n\napp = Flask(__name__)\napp.config[&apos;UPLOAD_FOLDER&apos;] = os.path.join(os.path.dirname(os.getcwd()),&apos;static&apos;,&apos;cav&apos;)\napp.config[&apos;MAX_CONTENT_LENGTH&apos;] = 16 * 1024 * 1024\n\n\nhtml = &apos;&apos;&apos;\n    &lt;!DOCTYPE html&gt;\n    &lt;title&gt;Upload File&lt;/title&gt;\n    &lt;h1&gt;图片上传&lt;/h1&gt;\n    &lt;form method=post enctype=multipart/form-data&gt;\n         &lt;input type=file name=file&gt;\n         &lt;input type=submit value=上传&gt;\n    &lt;/form&gt;\n    &apos;&apos;&apos;\n\n\ndef allowed_file(filename):\n    return &apos;.&apos; in filename and \\\n           filename.rsplit(&apos;.&apos;, 1)[1] in ALLOWED_EXTENSIONS\n\n\n@app.route(&apos;/uploads/&lt;filename&gt;&apos;)\ndef uploaded_file(filename):\n\n    return send_from_directory(app.config[&apos;UPLOAD_FOLDER&apos;],\n                               filename)\n\n\n@app.route(&apos;/&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;])\ndef upload_file():\n    if request.method == &apos;POST&apos;:\n        file = request.files[&apos;file&apos;]\n        if file and allowed_file(file.filename):\n            filename = secure_filename(file.filename)\n            logging.info(&apos;Upload path with : &apos;,os.path.join(app.config[&apos;UPLOAD_FOLDER&apos;], filename))\n            logging.info(app.config[&apos;UPLOAD_FOLDER&apos;])\n            file.save(os.path.join(app.config[&apos;UPLOAD_FOLDER&apos;], filename))\n            file_url = url_for(&apos;uploaded_file&apos;, filename=filename)\n            return html + &apos;&lt;br&gt;&lt;img src=&apos; + file_url + &apos;&gt;&apos;\n    return html\n\n\nif __name__ == &apos;__main__&apos;:\n    app.run()</code></pre>","categories":[{"name":"Python","slug":"Python","count":41,"path":"api/categories/Python.json"}],"tags":[{"name":"Python","slug":"Python","count":65,"path":"api/tags/Python.json"}]}