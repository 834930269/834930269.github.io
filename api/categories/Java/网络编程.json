{"name":"网络编程","slug":"Java/网络编程","count":1,"postlist":[{"title":"Let's Gank Java - 8st","slug":"lets-gank-java-8st","date":"2017-11-20T12:56:05.000Z","updated":"2019-07-03T13:51:36.859Z","comments":true,"path":"api/articles/lets-gank-java-8st.json","excerpt":"","keywords":null,"cover":"http://be-sunshine.cn/wp-content/uploads/2017/11/%E6%8D%95%E8%8E%B7-2.png","content":"<p>这次我们要用网络编程+正则+swing来实现获取百度显示关键字相关的功能. 首先,我们需要先在：<a href=\"http://hc.apache.org/downloads.cgi\" target=\"_blank\" rel=\"noopener\">http://hc.apache.org/downloads.cgi</a> 中下载 <code>4.5.3.zip</code>(根据平台选择,我这里选择的是Windows的)解压后,将lib中的所有jar包build到工程中,这样可以使用这个包内的网络操作相关方法. 然后就是另外一个问题,当我们使用String.replaceAll(regex,replacement)时,第一个参数为正则表达式,而第二个参数有三种情况: 1.替换目标正则得到的结果 2.${number} 符号表示目标正则得到的组(number为组数). 3.(暂时不知道,貌似是代表结束符) 官方文档: <strong>Note that backslashes () and dollar signs ($) in the replacement string may cause the results to be different than if it were being treated as a literal replacement string. Dollar signs may be treated as references to captured subsequences as described above, and backslashes are used to escape literal characters in the replacement string.</strong></p>\n<pre><code>import org.apache.http.*;\nimport org.apache.http.client.*;\nimport org.apache.http.client.fluent.*;\nimport java.io.IOException;\nimport java.io.UnsupportedEncodingException;\nimport java.net.URLEncoder;\n\nimport java.awt.*;\nimport java.awt.event.KeyAdapter;\nimport java.awt.event.KeyEvent;\nimport javax.swing.JFrame;\nimport javax.swing.JList;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTextField;\nimport javax.swing.SwingUtilities;\n\npublic class HttpSuggestion extends JFrame {\n    JTextField txtInput = new JTextField();\n    JList&lt;String&gt; lstSuggestion = new JList&lt;&gt;();\n\n    public HttpSuggestion(){\n        super(&quot;auto suggestion&quot;);//javax.swing.JFrame.JFrame(String title)\n        getContentPane().add(BorderLayout.NORTH,txtInput);\n        getContentPane().add(BorderLayout.CENTER,new JScrollPane(lstSuggestion));\n\n        setSize(300,200);\n        setDefaultCloseOperation(EXIT_ON_CLOSE);\n        setVisible(true);\n\n        txtInput.addKeyListener(new KeyAdapter(){\n            public void keyPressed(KeyEvent arg0){\n                /*\n                  当按键被按下时调用。 \n                 Invoked when a key has been pressed.\n                 */\n                new Thread(()-&gt;{\n                    try{\n                        String word = txtInput.getText();\n                        String[] suggestion = fetchSuggestion(word);\n                        //还记得之前说的么,在swing中多线程的函数必须调用SwingUtilities.invokeLater执行\n                        SwingUtilities.invokeLater(()-&gt;{\n                            //每次获取新信息就更新一次JList\n                            lstSuggestion.removeAll();\n                            lstSuggestion.setListData(suggestion);\n                            lstSuggestion.updateUI();\n                        });\n                    }catch(Exception ex){\n                        ex.printStackTrace();\n                    }\n                }).start();\n            }\n        });\n\n        //每当JList被选中时,更新Text内的内容\n        lstSuggestion.addListSelectionListener(e -&gt; {\n            txtInput.setText(lstSuggestion.getSelectedValue());\n        });\n    }\n\n    public static void main(String[] args)\n        throws Exception\n    {\n        //String word=&quot;人&quot;;\n        //fetchSuggestion(word);\n\n        SwingUtilities.invokeLater(()-&gt;{\n            new HttpSuggestion();\n        });\n    }\n\n    public static String[] fetchSuggestion(String word)\n            throws UnsupportedEncodingException, \n            ClientProtocolException,\n            IOException\n    {\n        //安全机制\n        if(word == null || word.length() == 0)\n            return new String[0];\n\n        String url=&quot;http://suggestion.baidu.com/su?wd=&quot;\n                + URLEncoder.encode(word,&quot;utf-8&quot;);\n        url += &quot;&amp;rnd=&quot; + Math.random();\n        //输出拼接后的url\n        System.out.println(url);\n\n        String content = Request.Get(url)\n                .addHeader(&quot;cookie&quot;,&quot;BDUSS=Aadasdfsfee&quot;).execute()\n                .returnContent().asString();\n        //输出返回的值\n        System.out.println(content);\n        //最后会返回类似\n        // window.baidu.sug({q:&quot;人&quot;,p:false,s:[&quot;人体艺术&quot;,&quot;人体艺术图片&quot;,&quot;人人网&quot;,&quot;人体艺术摄影&quot;,&quot;人民币对美元汇率&quot;,&quot;人体&quot;,&quot;人人贷&quot;,&quot;人人影视&quot;]});\n        String[] sug = content.replaceAll(&quot;.*,s:\\\\[([^]]*)\\\\].*&quot;,&quot;$1&quot;)\n                .replaceAll(&quot;\\&quot;&quot;, &quot;&quot;).split(&quot;,&quot;);\n        //输出瞅一瞅每次都转换了什么\n        for(String a : sug){\n            System.out.println(a);\n        }\n        String ss=content.replaceAll(&quot;.*,s:\\\\[([^]]*)\\\\].*&quot;,&quot;$1&quot;);\n        System.out.println(ss);\n        return sug;\n    }\n}</code></pre><p>结果: <a href=\"http://be-sunshine.cn/wp-content/uploads/2017/11/捕获-2.png\" target=\"_blank\" rel=\"noopener\"><img src=\"http://be-sunshine.cn/wp-content/uploads/2017/11/%E6%8D%95%E8%8E%B7-2.png\" alt></a></p>\n","text":"这次我们要用网络编程+正则+swing来实现获取百度显示关键字相关的功能. 首先,我们需要先在：http://hc.apache.org/downloads.cgi 中下载 4.5.3.zip(根据平台选择,我这里选择的是Windows的)解压后,将lib中的所有jar包buil","link":"","raw":null,"photos":[],"categories":[{"name":"Java","slug":"Java","count":21,"path":"api/categories/Java.json"},{"name":"网络编程","slug":"Java/网络编程","count":1,"path":"api/categories/Java/网络编程.json"}],"tags":[{"name":"Java","slug":"Java","count":21,"path":"api/tags/Java.json"},{"name":"网络编程","slug":"网络编程","count":4,"path":"api/tags/网络编程.json"}]}]}