{"name":"扩展欧几里得","slug":"UVa/扩展欧几里得","count":1,"postlist":[{"title":"POJ 1061","slug":"poj-1061","date":"2017-01-13T15:53:30.000Z","updated":"2019-07-03T13:51:36.845Z","comments":true,"path":"api/articles/poj-1061.json","excerpt":"","keywords":null,"cover":null,"content":"<p>【类型】 扩展欧几里得 【思路】 根据题意得方程:设跳t次遇见 (1) (x+mt)-(y+nt)=kL(因为一定是整数解(因为是整数解,所以符合扩欧)) (2)移项得:(n-m)t+kL=x-y &lt;=&gt; at+bL=z (3)扩欧定理中:a,b互质,只有整数解. (4)尝试z mod gcd(a,b)是否为0,如果为0则有解,不为0,则无解. (5)最后解得的t可能存在t&lt;0. (6)最后留下的一个疑问.为什么要 mod L/gcd(a,b)? 【Code】</p>\n<p>#include<iostream></iostream></p>\n<p>#include<algorithm><br>using namespace std;</algorithm></p>\n<p>typedef long long LL;</p>\n<p>LL gcd(LL a,LL b){<br>    if(b==0)return a;<br>    else return gcd(b,a%b);<br>}</p>\n<p>void exgcd(LL a,LL b,LL &amp;x,LL &amp;y){<br>    if(!b) x=1,y=0;<br>    else {exgcd(b,a%b,y,x); y-=x<em>(a/b);}<br>}<br>int main(){<br>    long long x,y,m,n,L,d,K,t,a,z,b;<br>    cin&gt;&gt;x&gt;&gt;y&gt;&gt;m&gt;&gt;n&gt;&gt;L;<br>    if(m==n){<br>        cout&lt;&lt;”Impossible\\n”;<br>        return 0;<br>    }<br>    a=n-m;<br>    z=x-y;<br>    b=L;<br>    d=gcd(a,b);<br>    if((x-y)%d){<br>        cout&lt;&lt;”Impossible\\n”;<br>        return 0;<br>    }<br>    a/=d;<br>    b/=d;<br>    z/=d;<br>    exgcd(a,b,t,K);<br>    K</em>=z;//z=(x-y)/gcd(a,b)-&gt;即扩大倍数k,这句等价于KL<br>    t*=z;//狮子等比扩大z倍;<br>    t=(t%b+b)%b;<br>    cout&lt;&lt;t&lt;&lt;”\\n”;<br>    return 0;<br>}</p>\n","text":"【类型】 扩展欧几里得 【思路】 根据题意得方程:设跳t次遇见 (1) (x+mt)-(y+nt)=kL(因为一定是整数解(因为是整数解,所以符合扩欧)) (2)移项得:(n-m)t+kL=x-y &lt;=&gt; at+bL=z (3)扩欧定理中:a,b互质,只有整数解. (","link":"","raw":null,"photos":[],"categories":[{"name":"UVa","slug":"UVa","count":35,"path":"api/categories/UVa.json"},{"name":"扩展欧几里得","slug":"UVa/扩展欧几里得","count":1,"path":"api/categories/UVa/扩展欧几里得.json"},{"name":"数论","slug":"UVa/扩展欧几里得/数论","count":1,"path":"api/categories/UVa/扩展欧几里得/数论.json"}],"tags":[{"name":"数论","slug":"数论","count":28,"path":"api/tags/数论.json"},{"name":"UVa","slug":"UVa","count":39,"path":"api/tags/UVa.json"}]}]}